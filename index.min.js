Alchemist=function(e){"use strict";function t(e){this.setElement(e)}var n,i,u;return i=t,n=t.prototype,i.className="Alchemist",u={},u.invalidElement="Invalid or unknown element was specified.",u.invalidElement=new Error(u.invalidElement),n.asElement=function(e){return e.constructor===String&&(e=document.querySelector(e)),"undefined"!=typeof jQuery&&e.constructor===jQuery&&(e=e.get(0)),e instanceof Element&&"TEMPLATE"===e.tagName&&(e=e.content),e instanceof DocumentFragment&&e.hasChildNodes()&&(e=e.firstElementChild),e instanceof Element?e:u.invalidElement},n.setElement=function(e){return this.element=this.asElement(e),this.element},n.getElement=function(){return this.element},n.toString=function(){return"[object "+this.name+"]"},t}(),new Nudist(Alchemist),Nudist=function(){"use strict";function e(e,t){this.expose(e,t)}var t,n;return n=e,t=e.prototype,n.className="Nudist",t.expose=function(e,t){"function"==typeof define&&define(e.name.toLowerCase(),[],function(){return e}),"undefined"!=typeof module&&(module.exports=e),"undefined"!=typeof window&&(window[e.name]=e),"undefined"!=typeof global&&(global[e.name]=e),t[e.name]=e},t.toString=function(){return"[object "+this.name+"]"},e}(),function(){if(this.queue)for(var e=0;e<this.queue.length;e++)new Nudist(this.queue[e],this)}.call(this),new Nudist(Nudist,this),Template=function(e){"use strict";function t(e,t){var n,i,u;return n=/[.{}]/g,i=function(e){return e},u=function(e,t){return e[t]},t.split(n).filter(i).reduce(u,e)}function n(e){return!!e}function i(e){this.initialize(),this.setElement(e)}var u,o;return o=i,u=i.prototype,o.className="Template",u.setElement=function(e){return"undefined"!=typeof Alchemist&&(e=Alchemist.prototype.asElement(e)),this.element=e,e},u.compile=function(e,n){var i,u;return i=/\{([^}]+)\}/g,u=function(e,i){return t(n,i)},e=e.trim(),e=e.replace(i,u)},u.crawl=function(e,t){var n,i,u,o;return u=this,o=arguments,n=function(e){var n,i;return i=function(n){var i;e.hasAttribute(n.name)&&(i=u.compile(n.value,t),e.setAttribute(n.name,i))},n=[].slice.call(e.attributes,0),n.map(i)},i=function(){var n,i,o,r,s=document.TEXT_NODE,c=document.ELEMENT_NODE;return n=function(t,n,i){e.childNodes[n]=u.crawl(t,i)},i=function(t,n,i){var o;o=u.compile(t.textContent,i),console.log(o),e.childNodes[n].innerHTML=o.outerHTML},r=function(e,u){e.nodeType===s&&i(e,u,t),e.nodeType===c&&n(e,u,t)},o=[].slice.call(e.childNodes,0),o.map(r)},e.hasAttributes()&&n(e,t),e.hasChildNodes()&&i(e,t),e},u.prepare=function(e){var t,i,u,o;return n(e)?(t=this.element.cloneNode(!0),o=this.crawl(t,e),i=t.innerHTML,u=/\{([^}]+)\}/g,t):void 0},u.pipe=function(){},u.initialize=function(){this.pipeline=[]},u.toString=function(){return"[object "+this.name+"]"},i}(),function(e){"use strict";return"undefined"==typeof Nudist?(this.queue=this.queue||[],this.queue.push(e)):new Nudist(e,this)}.call(this,Template);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsY2hlbWlzdC5qcyIsIm51ZGlzdC5qcyIsInV0ZW1wbGF0ZS5qcyJdLCJuYW1lcyI6WyJBbGNoZW1pc3QiLCJlbGVtZW50IiwidGhpcyIsInNldEVsZW1lbnQiLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsImVycm9yIiwiY2xhc3NOYW1lIiwiaW52YWxpZEVsZW1lbnQiLCJFcnJvciIsImFzRWxlbWVudCIsIlN0cmluZyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImpRdWVyeSIsImdldCIsIkVsZW1lbnQiLCJ0YWdOYW1lIiwiY29udGVudCIsIkRvY3VtZW50RnJhZ21lbnQiLCJoYXNDaGlsZE5vZGVzIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJnZXRFbGVtZW50IiwidG9TdHJpbmciLCJuYW1lIiwiTnVkaXN0IiwicHJvZ3JhbSIsInNjb3BlIiwiZXhwb3NlIiwiaW5wdXQiLCJkZWZpbmUiLCJ0b0xvd2VyQ2FzZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJ3aW5kb3ciLCJnbG9iYWwiLCJxdWV1ZSIsImkiLCJsZW5ndGgiLCJjYWxsIiwiVGVtcGxhdGUiLCJxdWVyeSIsIm9iamVjdCIsInByb3BlcnR5IiwicmVnZXgiLCJmaWx0ZXIiLCJyZWR1Y2UiLCJzb3VyY2UiLCJrZXkiLCJzcGxpdCIsInZhbGlkYXRlIiwiZGF0YSIsImluaXRpYWxpemUiLCJjb21waWxlIiwidmFsdWUiLCJyZXBsYWNlbWVudCIsIm9yaWdpbmFsIiwidHJpbSIsInJlcGxhY2UiLCJjcmF3bCIsImRvQXR0cmlidXRlcyIsImRvQ2hpbGRyZW4iLCJzZWxmIiwiYXJncyIsImFyZ3VtZW50cyIsImF0dHJpYnV0ZXMiLCJsb29wIiwiYXR0cmlidXRlIiwiY29tcGlsZWQiLCJoYXNBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJzbGljZSIsIm1hcCIsInNldFRleHROb2RlIiwiY2hpbGRyZW4iLCJ0ZXh0Tm9kZSIsIlRFWFRfTk9ERSIsImVsZW1lbnROb2RlIiwiRUxFTUVOVF9OT0RFIiwiY2hpbGQiLCJjaGlsZE5vZGVzIiwidGV4dENvbnRlbnQiLCJjb25zb2xlIiwibG9nIiwiaW5uZXJIVE1MIiwib3V0ZXJIVE1MIiwibm9kZVR5cGUiLCJoYXNBdHRyaWJ1dGVzIiwicHJlcGFyZSIsImh0bWwiLCJwcm9wZXJ0aWVzIiwicmVzb2x2ZSIsImNsb25lTm9kZSIsInBpcGUiLCJwaXBlbGluZSIsInB1c2giXSwibWFwcGluZ3MiOiJBQUFBQSxVQUFBLFNBQUFDLEdBQ0EsWUEyREEsU0FBQUQsR0FBQUMsR0FDQUMsS0FBQUMsV0FBQUYsR0ExREEsR0FBQUcsR0FDQUMsRUFFQUMsQ0EwREEsT0F4REFELEdBQUFMLEVBQ0FJLEVBQUFKLEVBQUFJLFVBRUFDLEVBQUFFLFVBQUEsWUFFQUQsS0FDQUEsRUFBQUUsZUFBQSw0Q0FDQUYsRUFBQUUsZUFBQSxHQUFBQyxPQUFBSCxFQUFBRSxnQkFFQUosRUFBQU0sVUFBQSxTQUFBVCxHQXNCQSxNQXBCQUEsR0FBQUksY0FBQU0sU0FDQVYsRUFBQVcsU0FBQUMsY0FBQVosSUFJQSxtQkFBQWEsU0FBQWIsRUFBQUksY0FBQVMsU0FDQWIsRUFBQUEsRUFBQWMsSUFBQSxJQUlBZCxZQUFBZSxVQUFBLGFBQUFmLEVBQUFnQixVQUNBaEIsRUFBQUEsRUFBQWlCLFNBSUFqQixZQUFBa0IsbUJBQUFsQixFQUFBbUIsa0JBQ0FuQixFQUFBQSxFQUFBb0IsbUJBSUFwQixZQUFBZSxTQUNBZixFQUdBSyxFQUFBRSxnQkFHQUosRUFBQUQsV0FBQSxTQUFBRixHQUdBLE1BRkFDLE1BQUFELFFBQUFDLEtBQUFRLFVBQUFULEdBRUFDLEtBQUFELFNBR0FHLEVBQUFrQixXQUFBLFdBQ0EsTUFBQXBCLE1BQUFELFNBR0FHLEVBQUFtQixTQUFBLFdBQ0EsTUFBQSxXQUFBckIsS0FBQXNCLEtBQUEsS0FPQXhCLEtBR0EsR0FBQXlCLFFBQUF6QixXQ2hFQXlCLE9BQUEsV0FDQSxZQWtDQSxTQUFBQSxHQUFBQyxFQUFBQyxHQUNBekIsS0FBQTBCLE9BQUFGLEVBQUFDLEdB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YyxHQUVBNEIsRUFBQU8sV0FBQVQsR0FDQTFFLEVBQUE0RSxFQUFBMUMsRUFBQWMsSUFJQXVCLEtBQUFILE1BQUFoQyxLQUFBdEMsRUFBQStFLFdBQUEsR0FFQU4sRUFBQUYsSUFBQU4sSUFHQWpFLEVBQUFzRixpQkFDQTNCLEVBQUEzRCxFQUFBa0QsR0FHQWxELEVBQUFtQixpQkFDQXlDLEVBQUE1RCxFQUFBa0QsR0FHQWxELEdBb0JBRyxFQUFBb0YsUUFBQSxTQUFBckMsR0FDQSxHQUFBbEQsR0FDQXdGLEVBQ0FDLEVBQ0FDLENBRUEsT0FBQXpDLEdBQUFDLElBRUFsRCxFQUFBQyxLQUFBRCxRQUFBMkYsV0FBQSxHQUNBRCxFQUFBekYsS0FBQXlELE1BQUExRCxFQUFBa0QsR0FFQXNDLEVBQUF4RixFQUFBbUYsVUFFQU0sRUFBQSxlQUVBekYsR0FUQSxRQWFBRyxFQUFBeUYsS0FBQSxhQUtBekYsRUFBQWdELFdBQUEsV0FDQWxELEtBQUE0RixhQUdBMUYsRUFBQW1CLFNBQUEsV0FDQSxNQUFBLFdBQUFyQixLQUFBc0IsS0FBQSxLQVFBZ0IsS0FHQSxTQUFBZCxHQUNBLFlBRUEsT0FBQSxtQkFBQUQsU0FDQXZCLEtBQUFrQyxNQUFBbEMsS0FBQWtDLFVBQ0FsQyxLQUFBa0MsTUFBQTJELEtBQUFyRSxJQUdBLEdBQUFELFFBQUFDLEVBQUF4QixPQUNBcUMsS0FBQXJDLEtBQUFzQyIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJBbGNoZW1pc3QgPSAoZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgdmFyIHByb3RvdHlwZTtcclxuICB2YXIgY29uc3RydWN0b3I7XHJcblxyXG4gIHZhciBlcnJvcjtcclxuXHJcbiAgY29uc3RydWN0b3IgPSBBbGNoZW1pc3Q7XHJcbiAgcHJvdG90eXBlID0gQWxjaGVtaXN0LnByb3RvdHlwZTtcclxuXHJcbiAgY29uc3RydWN0b3IuY2xhc3NOYW1lID0gXCJBbGNoZW1pc3RcIjtcclxuXHJcbiAgZXJyb3IgPSB7fTtcclxuICBlcnJvci5pbnZhbGlkRWxlbWVudCA9IFwiSW52YWxpZCBvciB1bmtub3duIGVsZW1lbnQgd2FzIHNwZWNpZmllZC5cIjtcclxuICBlcnJvci5pbnZhbGlkRWxlbWVudCA9IG5ldyBFcnJvcihlcnJvci5pbnZhbGlkRWxlbWVudCk7XHJcblxyXG4gIHByb3RvdHlwZS5hc0VsZW1lbnQgPSBmdW5jdGlvbiBhc0VsZW1lbnQoZWxlbWVudCkge1xyXG4gICAgLy8gZmluZCBzcGVjaWZpZWQgZWxlbWVudFxyXG4gICAgaWYgKGVsZW1lbnQuY29uc3RydWN0b3IgPT09IFN0cmluZykge1xyXG4gICAgICBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBpdCdzIGEgalF1ZXJ5IG5vZGVcclxuICAgIGlmICh0eXBlb2YgalF1ZXJ5ICE9PSAndW5kZWZpbmVkJyAmJiBlbGVtZW50LmNvbnN0cnVjdG9yID09PSBqUXVlcnkpIHtcclxuICAgICAgZWxlbWVudCA9IGVsZW1lbnQuZ2V0KDApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGh0bWw1IHRlbXBsYXRlIGNvbnRlbnRcclxuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCAmJiBlbGVtZW50LnRhZ05hbWUgPT09ICdURU1QTEFURScpIHtcclxuICAgICAgZWxlbWVudCA9IGVsZW1lbnQuY29udGVudDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBkZWZyYWdtZW50XHJcbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIERvY3VtZW50RnJhZ21lbnQgJiYgZWxlbWVudC5oYXNDaGlsZE5vZGVzKCkpIHtcclxuICAgICAgZWxlbWVudCA9IGVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZWxlbWVudCBpcyBhbHJlYWR5IHByb3ZpZGVkXHJcbiAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcclxuICAgICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGVycm9yLmludmFsaWRFbGVtZW50O1xyXG4gIH07XHJcblxyXG4gIHByb3RvdHlwZS5zZXRFbGVtZW50ID0gZnVuY3Rpb24gc2V0RWxlbWVudChlbGVtZW50KSB7XHJcbiAgICB0aGlzLmVsZW1lbnQgPSB0aGlzLmFzRWxlbWVudChlbGVtZW50KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5lbGVtZW50O1xyXG4gIH07XHJcblxyXG4gIHByb3RvdHlwZS5nZXRFbGVtZW50ID0gZnVuY3Rpb24gZ2V0RWxlbWVudCgpIHtcclxuICAgIHJldHVybiB0aGlzLmVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgcHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XHJcbiAgICByZXR1cm4gJ1tvYmplY3QgJyArIHRoaXMubmFtZSArICddJztcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBBbGNoZW1pc3QoZWxlbWVudCkge1xyXG4gICAgdGhpcy5zZXRFbGVtZW50KGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIEFsY2hlbWlzdDtcclxufSgpKTtcclxuXHJcbm5ldyBOdWRpc3QoQWxjaGVtaXN0KTtcclxuIiwiLy8gWW91IHdpbGwgcHJvYmFibHkgbmV2ZXIgaGF2ZSB0byB0b3VjaCB0aGlzIGZpbGUuLi5cclxuLy8gSXQgZGV0ZWN0cyB0aGUgZW52aXJvbm1lbnQgYW5kIHNlcnZpY2UgYW5kIGV4cG9ydHMgdGhlIG1vZHVsZSBhY2NvcmRpbmdseS5cclxuXHJcbk51ZGlzdCA9IChmdW5jdGlvbigpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIHZhciBwcm90b3R5cGU7XHJcbiAgdmFyIGNvbnN0cnVjdG9yO1xyXG5cclxuICBjb25zdHJ1Y3RvciA9IE51ZGlzdDtcclxuICBwcm90b3R5cGUgPSBOdWRpc3QucHJvdG90eXBlO1xyXG5cclxuICBjb25zdHJ1Y3Rvci5jbGFzc05hbWUgPSAnTnVkaXN0JztcclxuXHJcbiAgcHJvdG90eXBlLmV4cG9zZSA9IGZ1bmN0aW9uIGV4cG9zZShpbnB1dCwgc2NvcGUpIHtcclxuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGRlZmluZShpbnB1dC5uYW1lLnRvTG93ZXJDYXNlKCksIFtdLCBmdW5jdGlvbiAoKSB7IHJldHVybiBpbnB1dDsgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGlucHV0O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB3aW5kb3dbaW5wdXQubmFtZV0gPSBpbnB1dDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgZ2xvYmFsW2lucHV0Lm5hbWVdID0gaW5wdXQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2NvcGVbaW5wdXQubmFtZV0gPSBpbnB1dDtcclxuICB9O1xyXG5cclxuICBwcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcclxuICAgIHJldHVybiAnW29iamVjdCAnICsgdGhpcy5uYW1lICsgJ10nXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gTnVkaXN0KHByb2dyYW0sIHNjb3BlKSB7XHJcbiAgICB0aGlzLmV4cG9zZShwcm9ncmFtLCBzY29wZSk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gTnVkaXN0O1xyXG59KCkpO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gIGlmICghIXRoaXMucXVldWUpIHtcclxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5xdWV1ZS5sZW5ndGg7IGkrKykge1xyXG4gICAgICBuZXcgTnVkaXN0KHRoaXMucXVldWVbaV0sIHRoaXMpO1xyXG4gICAgfVxyXG4gIH1cclxufSkuY2FsbCh0aGlzKTtcclxuXHJcbm5ldyBOdWRpc3QoTnVkaXN0LCB0aGlzKTtcclxuIiwiVGVtcGxhdGUgPSAoZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgdmFyIHByb3RvdHlwZTtcclxuICB2YXIgY29uc3RydWN0b3I7XHJcblxyXG4gIGNvbnN0cnVjdG9yID0gVGVtcGxhdGU7XHJcbiAgcHJvdG90eXBlID0gVGVtcGxhdGUucHJvdG90eXBlO1xyXG5cclxuICBjb25zdHJ1Y3Rvci5jbGFzc05hbWUgPSBcIlRlbXBsYXRlXCI7XHJcblxyXG4gIGZ1bmN0aW9uIHF1ZXJ5KG9iamVjdCwgcHJvcGVydHkpIHtcclxuICAgIHZhciByZWdleDtcclxuICAgIHZhciBmaWx0ZXI7XHJcbiAgICB2YXIgcmVkdWNlO1xyXG5cclxuICAgIHJlZ2V4ID0gL1sue31dL2c7XHJcbiAgICBmaWx0ZXIgPSBmdW5jdGlvbiBmaWx0ZXIoc291cmNlKSB7IHJldHVybiBzb3VyY2U7IH07XHJcbiAgICByZWR1Y2UgPSBmdW5jdGlvbiByZWR1Y2Uoc291cmNlLCBrZXkpIHsgcmV0dXJuIHNvdXJjZVtrZXldOyB9O1xyXG5cclxuICAgIHJldHVybiBwcm9wZXJ0eVxyXG4gICAgICAuc3BsaXQocmVnZXgpXHJcbiAgICAgIC5maWx0ZXIoZmlsdGVyKVxyXG4gICAgICAucmVkdWNlKHJlZHVjZSwgb2JqZWN0KTtcclxuICB9XHJcblxyXG4gIHByb3RvdHlwZS5zZXRFbGVtZW50ID0gZnVuY3Rpb24gc2V0RWxlbWVudChlbGVtZW50KSB7XHJcbiAgICBpZiAodHlwZW9mIEFsY2hlbWlzdCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgZWxlbWVudCA9IEFsY2hlbWlzdC5wcm90b3R5cGUuYXNFbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblxyXG4gICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgcHJvdG90eXBlLmNvbXBpbGUgPSBmdW5jdGlvbiBjb21waWxlKHZhbHVlLCBkYXRhKSB7XHJcbiAgICB2YXIgcmVnZXg7XHJcbiAgICB2YXIgcmVwbGFjZW1lbnQ7XHJcblxyXG4gICAgcmVnZXggPSAvXFx7KFtefV0rKVxcfS9nO1xyXG5cclxuICAgIHJlcGxhY2VtZW50ID0gZnVuY3Rpb24gcmVwbGFjZW1lbnQob3JpZ2luYWwsIHByb3BlcnR5KSB7XHJcbiAgICAgIHJldHVybiBxdWVyeShkYXRhLCBwcm9wZXJ0eSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhbHVlID0gdmFsdWUudHJpbSgpO1xyXG4gICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCByZXBsYWNlbWVudCk7XHJcblxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG4gIH07XHJcblxyXG4gIHByb3RvdHlwZS5jcmF3bCA9IGZ1bmN0aW9uIGNyYXdsKGVsZW1lbnQsIGRhdGEpIHtcclxuICAgIHZhciBkb0F0dHJpYnV0ZXM7XHJcbiAgICB2YXIgZG9DaGlsZHJlbjtcclxuXHJcbiAgICB2YXIgc2VsZiwgYXJncztcclxuXHJcbiAgICBzZWxmID0gdGhpcztcclxuICAgIGFyZ3MgPSBhcmd1bWVudHM7XHJcblxyXG4gICAgZG9BdHRyaWJ1dGVzID0gZnVuY3Rpb24gZG9BdHRyaWJ1dGVzKGVsZW1lbnQpIHtcclxuICAgICAgdmFyIGF0dHJpYnV0ZXM7XHJcbiAgICAgIHZhciBhdHRyaWJ1dGU7XHJcblxyXG4gICAgICB2YXIgbG9vcDtcclxuXHJcbiAgICAgIGxvb3AgPSBmdW5jdGlvbiBsb29wKGF0dHJpYnV0ZSkge1xyXG4gICAgICAgIHZhciBjb21waWxlZDtcclxuXHJcbiAgICAgICAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZS5uYW1lKSkge1xyXG4gICAgICAgICAgY29tcGlsZWQgPSBzZWxmLmNvbXBpbGUoYXR0cmlidXRlLnZhbHVlLCBkYXRhKTtcclxuICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZS5uYW1lLCBjb21waWxlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgYXR0cmlidXRlcyA9IChbXSkuc2xpY2UuY2FsbChlbGVtZW50LmF0dHJpYnV0ZXMsIDApO1xyXG5cclxuICAgICAgcmV0dXJuIGF0dHJpYnV0ZXMubWFwKGxvb3ApO1xyXG4gICAgfTtcclxuXHJcbiAgICBkb0NoaWxkcmVuID0gZnVuY3Rpb24gZG9DaGlsZHJlbigpIHtcclxuICAgICAgdmFyIHRleHROb2RlID0gZG9jdW1lbnQuVEVYVF9OT0RFO1xyXG4gICAgICB2YXIgZWxlbWVudE5vZGUgPSBkb2N1bWVudC5FTEVNRU5UX05PREU7XHJcblxyXG4gICAgICB2YXIgc2V0RWxlbWVudDtcclxuICAgICAgdmFyIHNldFRleHROb2RlO1xyXG5cclxuICAgICAgdmFyIGNoaWxkcmVuO1xyXG4gICAgICB2YXIgY2hpbGQ7XHJcblxyXG4gICAgICB2YXIgbG9vcDtcclxuICAgICAgdmFyIGZpeEVsZW1lbnQ7XHJcbiAgICAgIHZhciBmaXhUZXh0Tm9kZTtcclxuXHJcbiAgICAgIHNldEVsZW1lbnQgPSBmdW5jdGlvbiBzZXRFbGVtZW50KGNoaWxkLCBpLCBkYXRhKSB7XHJcbiAgICAgICAgZWxlbWVudC5jaGlsZE5vZGVzW2ldID0gc2VsZi5jcmF3bChjaGlsZCwgZGF0YSk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBzZXRUZXh0Tm9kZSA9IGZ1bmN0aW9uIHNldFRleHROb2RlKGNoaWxkLCBpLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIGNvbXBpbGVkO1xyXG5cclxuICAgICAgICBjb21waWxlZCA9IHNlbGYuY29tcGlsZShjaGlsZC50ZXh0Q29udGVudCwgZGF0YSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coY29tcGlsZWQpO1xyXG4gICAgICAgIGVsZW1lbnQuY2hpbGROb2Rlc1tpXS5pbm5lckhUTUwgPSBjb21waWxlZC5vdXRlckhUTUw7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBsb29wID0gZnVuY3Rpb24gbG9vcChjaGlsZCwgaSkge1xyXG4gICAgICAgIGlmKGNoaWxkLm5vZGVUeXBlID09PSB0ZXh0Tm9kZSkge1xyXG4gICAgICAgICAgc2V0VGV4dE5vZGUoY2hpbGQsIGksIGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2hpbGQubm9kZVR5cGUgPT09IGVsZW1lbnROb2RlKSB7XHJcbiAgICAgICAgICBzZXRFbGVtZW50KGNoaWxkLCBpLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjaGlsZHJlbiA9IChbXSkuc2xpY2UuY2FsbChlbGVtZW50LmNoaWxkTm9kZXMsIDApO1xyXG5cclxuICAgICAgcmV0dXJuIGNoaWxkcmVuLm1hcChsb29wKTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlcygpKSB7XHJcbiAgICAgIGRvQXR0cmlidXRlcyhlbGVtZW50LCBkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZWxlbWVudC5oYXNDaGlsZE5vZGVzKCkpIHtcclxuICAgICAgZG9DaGlsZHJlbihlbGVtZW50LCBkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZWxlbWVudDtcclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBoYXNQcm9wZXJ0aWVzKG9iamVjdCwgYXJyYXkpIHtcclxuICAgIHZhciBhcmVNaXNzaW5nO1xyXG5cclxuICAgIGFyZU1pc3NpbmcgPSBmdW5jdGlvbiBhcmVNaXNzaW5nKHByb3BlcnR5KSB7XHJcbiAgICAgICAgcmV0dXJuICFvYmplY3QuaGFzT3duUHJvcGVydHkocHJvcGVydHkpO1xyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gYXJyYXkuc29tZShhcmVNaXNzaW5nKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHZhbGlkYXRlKGRhdGEpIHtcclxuICAgIGlmICghZGF0YSkge1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIHByb3RvdHlwZS5wcmVwYXJlID0gZnVuY3Rpb24gcHJlcGFyZShkYXRhKSB7XHJcbiAgICB2YXIgZWxlbWVudDtcclxuICAgIHZhciBodG1sO1xyXG4gICAgdmFyIHByb3BlcnRpZXM7XHJcbiAgICB2YXIgcmVzb2x2ZTtcclxuXHJcbiAgICBpZiAodmFsaWRhdGUoZGF0YSkpIHtcclxuXHJcbiAgICAgIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICByZXNvbHZlID0gdGhpcy5jcmF3bChlbGVtZW50LCBkYXRhKTtcclxuXHJcbiAgICAgIGh0bWwgPSBlbGVtZW50LmlubmVySFRNTDtcclxuXHJcbiAgICAgIHByb3BlcnRpZXMgPSAvXFx7KFtefV0rKVxcfS9nO1xyXG5cclxuICAgICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcHJvdG90eXBlLnBpcGUgPSBmdW5jdGlvbiBwaXBlKCkge1xyXG4gICAgLy8gcmVzb2x2ZSBkdXBsaWNhdGVzXHJcbiAgICAvLyB0aGlzLnBpcGVsaW5lLnB1c2goZmxvdyk7XHJcbiAgfTtcclxuXHJcbiAgcHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiBpbml0aWFsaXplKCkge1xyXG4gICAgdGhpcy5waXBlbGluZSA9IFtdO1xyXG4gIH07XHJcblxyXG4gIHByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xyXG4gICAgcmV0dXJuICdbb2JqZWN0ICcgKyB0aGlzLm5hbWUgKyAnXSc7XHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gVGVtcGxhdGUoZWxlbWVudCkge1xyXG4gICAgdGhpcy5pbml0aWFsaXplKCk7XHJcbiAgICB0aGlzLnNldEVsZW1lbnQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gVGVtcGxhdGU7XHJcbn0oKSk7XHJcblxyXG4oZnVuY3Rpb24ocHJvZ3JhbSl7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICBpZiAodHlwZW9mIE51ZGlzdCA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgIHRoaXMucXVldWUgPSB0aGlzLnF1ZXVlIHx8IFtdXHJcbiAgICByZXR1cm4gdGhpcy5xdWV1ZS5wdXNoKHByb2dyYW0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIG5ldyBOdWRpc3QocHJvZ3JhbSwgdGhpcyk7XHJcbn0pLmNhbGwodGhpcywgVGVtcGxhdGUpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
