Alchemist=function(e){"use strict";function t(e){this.setElement(e)}var n,i,o;return i=t,n=t.prototype,i.className="Alchemist",o={},o.invalidElement="Invalid or unknown element was specified.",o.invalidElement=new Error(o.invalidElement),n.asElement=function(e){return e.constructor===String&&(e=document.querySelector(e)),"undefined"!=typeof jQuery&&e.constructor===jQuery&&(e=e.get(0)),e instanceof Element&&"TEMPLATE"===e.tagName&&(e=e.content),e instanceof DocumentFragment&&e.hasChildNodes()&&(e=e.firstElementChild),e instanceof Element?e:o.invalidElement},n.setElement=function(e){return this.element=this.asElement(e),this.element},n.getElement=function(){return this.element},n.toString=function(){return"[object "+this.name+"]"},t}(),module.exports=alchemist,Nudist=function(e){"use strict";function t(e){this.expose(e)}var n,i;return i=t,n=t.prototype,i.className="Nudist",n.expose=function(e,t){"function"==typeof define&&define(e.name.toLowerCase(),[],function(){return e}),"undefined"!=typeof module&&(module.exports=e),"undefined"!=typeof window&&(window[e.name]=e),"undefined"!=typeof global&&(global[e.name]=e),t[e.name]=e},n.toString=function(){return"[object "+this.name+"]"},t}(this),function(){if(this.queue)for(var e=0;e<this.queue.length;e++)new Nudist(this.queue[e],this)}.call(this),new Nudist(Nudist,this);var Template,Alchemist;Alchemist=require("./alchemist"),Template=function(e){"use strict";function t(e,t){var n,i,o;return n=/[.{}]/g,i=function(e){return e},o=function(e,t){return e[t]},t.split(n).filter(i).reduce(o,e)}function n(e){return!!e}function i(e){this.initialize(),this.setElement(e)}var o,r;return r=i,o=i.prototype,r.className="Template",o.setElement=function(e){return"undefined"!=typeof Alchemist&&(e=Alchemist.prototype.asElement(e)),this.element=e,e},o.compile=function(e,n){var i,o;return i=/\{([^}]+)\}/g,o=function(e,i){return t(n,i)},e=e.trim(),e=e.replace(i,o)},o.crawl=function(e,t){var n,i,o,r;return o=this,r=arguments,n=function(e){var n,i;return i=function(n){var i;e.hasAttribute(n.name)&&(i=o.compile(n.value,t),e.setAttribute(n.name,i))},n=[].slice.call(e.attributes,0),n.map(i)},i=function(){var n,i,r,u,s=document.TEXT_NODE,c=document.ELEMENT_NODE;return n=function(t,n,i){e.childNodes[n]=o.crawl(t,i)},i=function(t,n,i){var r;r=o.compile(t.textContent,i),e.childNodes[n].textContent=r.textContent},u=function(e,o){e.nodeType===s&&i(e,o,t),e.nodeType===c&&n(e,o,t)},r=[].slice.call(e.childNodes,0),r.map(u)},e.hasAttributes()&&n(e,t),e.hasChildNodes()&&i(e,t),e},o.prepare=function(e){var t,i,o,r;return n(e)?(t=this.element.cloneNode(!0),r=this.crawl(t,e),i=t.innerHTML,o=/\{([^}]+)\}/g,t):void 0},o.pipe=function(){},o.initialize=function(){this.pipeline=[]},o.toString=function(){return"[object "+this.name+"]"},i}(),module.exports=Template;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsY2hlbWlzdC5qcyIsIm51ZGlzdC5qcyIsInV0ZW1wbGF0ZS5qcyJdLCJuYW1lcyI6WyJBbGNoZW1pc3QiLCJlbGVtZW50IiwidGhpcyIsInNldEVsZW1lbnQiLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsImVycm9yIiwiY2xhc3NOYW1lIiwiaW52YWxpZEVsZW1lbnQiLCJFcnJvciIsImFzRWxlbWVudCIsIlN0cmluZyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImpRdWVyeSIsImdldCIsIkVsZW1lbnQiLCJ0YWdOYW1lIiwiY29udGVudCIsIkRvY3VtZW50RnJhZ21lbnQiLCJoYXNDaGlsZE5vZGVzIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJnZXRFbGVtZW50IiwidG9TdHJpbmciLCJuYW1lIiwibW9kdWxlIiwiZXhwb3J0cyIsImFsY2hlbWlzdCIsIk51ZGlzdCIsInNjb3BlIiwicHJvZ3JhbSIsImV4cG9zZSIsImlucHV0IiwiZGVmaW5lIiwidG9Mb3dlckNhc2UiLCJ3aW5kb3ciLCJnbG9iYWwiLCJxdWV1ZSIsImkiLCJsZW5ndGgiLCJjYWxsIiwiVGVtcGxhdGUiLCJyZXF1aXJlIiwicXVlcnkiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInJlZ2V4IiwiZmlsdGVyIiwicmVkdWNlIiwic291cmNlIiwia2V5Iiwic3BsaXQiLCJ2YWxpZGF0ZSIsImRhdGEiLCJpbml0aWFsaXplIiwiY29tcGlsZSIsInZhbHVlIiwicmVwbGFjZW1lbnQiLCJvcmlnaW5hbCIsInRyaW0iLCJyZXBsYWNlIiwiY3Jhd2wiLCJkb0F0dHJpYnV0ZXMiLCJkb0NoaWxkcmVuIiwic2VsZiIsImFyZ3MiLCJhcmd1bWVudHMiLCJhdHRyaWJ1dGVzIiwibG9vcCIsImF0dHJpYnV0ZSIsImNvbXBpbGVkIiwiaGFzQXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwic2xpY2UiLCJtYXAiLCJzZXRUZXh0Tm9kZSIsImNoaWxkcmVuIiwidGV4dE5vZGUiLCJURVhUX05PREUiLCJlbGVtZW50Tm9kZSIsIkVMRU1FTlRfTk9ERSIsImNoaWxkIiwiY2hpbGROb2RlcyIsInRleHRDb250ZW50Iiwibm9kZVR5cGUiLCJoYXNBdHRyaWJ1dGVzIiwicHJlcGFyZSIsImh0bWwiLCJwcm9wZXJ0aWVzIiwicmVzb2x2ZSIsImNsb25lTm9kZSIsImlubmVySFRNTCIsInBpcGUiLCJwaXBlbGluZSJdLCJtYXBwaW5ncyI6IkFBQUFBLFVBQUEsU0FBQUMsR0FDQSxZQTJEQSxTQUFBRCxHQUFBQyxHQUNBQyxLQUFBQyxXQUFBRixHQTFEQSxHQUFBRyxHQUNBQyxFQUVBQyxDQTBEQSxPQXhEQUQsR0FBQUwsRUFDQUksRUFBQUosRUFBQUksVUFFQUMsRUFBQUUsVUFBQSxZQUVBRCxLQUNBQSxFQUFBRSxlQUFBLDRDQUNBRixFQUFBRSxlQUFBLEdBQUFDLE9BQUFILEVBQUFFLGdCQUVBSixFQUFBTSxVQUFBLFNBQUFULEdBc0JBLE1BcEJBQSxHQUFBSSxjQUFBTSxTQUNBVixFQUFBVyxTQUFBQyxjQUFBWixJQUlBLG1CQUFBYSxTQUFBYixFQUFBSSxjQUFBUyxTQUNBYixFQUFBQSxFQUFBYyxJQUFBLElBSUFkLFlBQUFlLFVBQUEsYUFBQWYsRUFBQWdCLFVBQ0FoQixFQUFBQSxFQUFBaUIsU0FJQWpCLFlBQUFrQixtQkFBQWxCLEVBQUFtQixrQkFDQW5CLEVBQUFBLEVBQUFvQixtQkFJQXBCLFlBQUFlLFNBQ0FmLEVBR0FLLEVBQUFFLGdCQUdBSixFQUFBRCxXQUFBLFNBQUFGLEdBR0EsTUFGQUMsTUFBQUQsUUFBQUMsS0FBQVEsVUFBQVQsR0FFQUMsS0FBQUQsU0FHQUcsRUFBQWtCLFdBQUEsV0FDQSxNQUFBcEIsTUFBQUQsU0FHQUcsRUFBQW1CLFNBQUEsV0FDQSxNQUFBLFdBQUFyQixLQUFBc0IsS0FBQSxLQU9BeEIsS0FHQXlCLE9BQUFDLFFBQUFDLFVDaEVBQyxPQUFBLFNBQUFDLEdBQ0EsWUFrQ0EsU0FBQUQsR0FBQUUsR0FDQTVCLEtBQUE2QixPQUFBRCxHQWpDQSxHQUFBMUIsR0FDQUMsQ0Ft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ZSxHQUVBNEIsRUFBQUcsV0FBQUwsR0FDQTVFLEVBQUE4RSxFQUFBM0MsRUFBQWUsSUFJQXVCLEtBQUFILE1BQUFqQyxLQUFBdkMsRUFBQWlGLFdBQUEsR0FFQU4sRUFBQUYsSUFBQU4sSUFHQW5FLEVBQUFvRixpQkFDQXZCLEVBQUE3RCxFQUFBb0QsR0FHQXBELEVBQUFtQixpQkFDQTJDLEVBQUE5RCxFQUFBb0QsR0FHQXBELEdBb0JBRyxFQUFBa0YsUUFBQSxTQUFBakMsR0FDQSxHQUFBcEQsR0FDQXNGLEVBQ0FDLEVBQ0FDLENBRUEsT0FBQXJDLEdBQUFDLElBRUFwRCxFQUFBQyxLQUFBRCxRQUFBeUYsV0FBQSxHQUNBRCxFQUFBdkYsS0FBQTJELE1BQUE1RCxFQUFBb0QsR0FFQWtDLEVBQUF0RixFQUFBMEYsVUFFQUgsRUFBQSxlQUVBdkYsR0FUQSxRQWFBRyxFQUFBd0YsS0FBQSxhQUtBeEYsRUFBQWtELFdBQUEsV0FDQXBELEtBQUEyRixhQUdBekYsRUFBQW1CLFNBQUEsV0FDQSxNQUFBLFdBQUFyQixLQUFBc0IsS0FBQSxLQVFBaUIsS0FHQWhCLE9BQUFDLFFBQUFlIiwiZmlsZSI6ImluZGV4Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIkFsY2hlbWlzdCA9IChmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICB2YXIgcHJvdG90eXBlO1xyXG4gIHZhciBjb25zdHJ1Y3RvcjtcclxuXHJcbiAgdmFyIGVycm9yO1xyXG5cclxuICBjb25zdHJ1Y3RvciA9IEFsY2hlbWlzdDtcclxuICBwcm90b3R5cGUgPSBBbGNoZW1pc3QucHJvdG90eXBlO1xyXG5cclxuICBjb25zdHJ1Y3Rvci5jbGFzc05hbWUgPSBcIkFsY2hlbWlzdFwiO1xyXG5cclxuICBlcnJvciA9IHt9O1xyXG4gIGVycm9yLmludmFsaWRFbGVtZW50ID0gXCJJbnZhbGlkIG9yIHVua25vd24gZWxlbWVudCB3YXMgc3BlY2lmaWVkLlwiO1xyXG4gIGVycm9yLmludmFsaWRFbGVtZW50ID0gbmV3IEVycm9yKGVycm9yLmludmFsaWRFbGVtZW50KTtcclxuXHJcbiAgcHJvdG90eXBlLmFzRWxlbWVudCA9IGZ1bmN0aW9uIGFzRWxlbWVudChlbGVtZW50KSB7XHJcbiAgICAvLyBmaW5kIHNwZWNpZmllZCBlbGVtZW50XHJcbiAgICBpZiAoZWxlbWVudC5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7XHJcbiAgICAgIGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGl0J3MgYSBqUXVlcnkgbm9kZVxyXG4gICAgaWYgKHR5cGVvZiBqUXVlcnkgIT09ICd1bmRlZmluZWQnICYmIGVsZW1lbnQuY29uc3RydWN0b3IgPT09IGpRdWVyeSkge1xyXG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5nZXQoMCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gaHRtbDUgdGVtcGxhdGUgY29udGVudFxyXG4gICAgaWYgKGVsZW1lbnQgaW5zdGFuY2VvZiBFbGVtZW50ICYmIGVsZW1lbnQudGFnTmFtZSA9PT0gJ1RFTVBMQVRFJykge1xyXG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5jb250ZW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIGRlZnJhZ21lbnRcclxuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgRG9jdW1lbnRGcmFnbWVudCAmJiBlbGVtZW50Lmhhc0NoaWxkTm9kZXMoKSkge1xyXG4gICAgICBlbGVtZW50ID0gZWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBlbGVtZW50IGlzIGFscmVhZHkgcHJvdmlkZWRcclxuICAgIGlmIChlbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCkge1xyXG4gICAgICByZXR1cm4gZWxlbWVudDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZXJyb3IuaW52YWxpZEVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgcHJvdG90eXBlLnNldEVsZW1lbnQgPSBmdW5jdGlvbiBzZXRFbGVtZW50KGVsZW1lbnQpIHtcclxuICAgIHRoaXMuZWxlbWVudCA9IHRoaXMuYXNFbGVtZW50KGVsZW1lbnQpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLmVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgcHJvdG90eXBlLmdldEVsZW1lbnQgPSBmdW5jdGlvbiBnZXRFbGVtZW50KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcclxuICB9O1xyXG5cclxuICBwcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcclxuICAgIHJldHVybiAnW29iamVjdCAnICsgdGhpcy5uYW1lICsgJ10nO1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIEFsY2hlbWlzdChlbGVtZW50KSB7XHJcbiAgICB0aGlzLnNldEVsZW1lbnQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gQWxjaGVtaXN0O1xyXG59KCkpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBhbGNoZW1pc3Q7XHJcbiIsIi8vIFlvdSB3aWxsIHByb2JhYmx5IG5ldmVyIGhhdmUgdG8gdG91Y2ggdGhpcyBmaWxlLi4uXHJcbi8vIEl0IGRldGVjdHMgdGhlIGVudmlyb25tZW50IGFuZCBzZXJ2aWNlIGFuZCBleHBvcnRzIHRoZSBtb2R1bGUgYWNjb3JkaW5nbHkuXHJcblxyXG5OdWRpc3QgPSAoZnVuY3Rpb24oc2NvcGUpIHtcclxuICAndXNlIHN0cmljdCc7XHJcblxyXG4gIHZhciBwcm90b3R5cGU7XHJcbiAgdmFyIGNvbnN0cnVjdG9yO1xyXG5cclxuICBjb25zdHJ1Y3RvciA9IE51ZGlzdDtcclxuICBwcm90b3R5cGUgPSBOdWRpc3QucHJvdG90eXBlO1xyXG5cclxuICBjb25zdHJ1Y3Rvci5jbGFzc05hbWUgPSAnTnVkaXN0JztcclxuXHJcbiAgcHJvdG90eXBlLmV4cG9zZSA9IGZ1bmN0aW9uIGV4cG9zZShpbnB1dCwgc2NvcGUpIHtcclxuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGRlZmluZShpbnB1dC5uYW1lLnRvTG93ZXJDYXNlKCksIFtdLCBmdW5jdGlvbiAoKSB7IHJldHVybiBpbnB1dDsgfSApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICBtb2R1bGUuZXhwb3J0cyA9IGlucHV0O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB3aW5kb3dbaW5wdXQubmFtZV0gPSBpbnB1dDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgZ2xvYmFsW2lucHV0Lm5hbWVdID0gaW5wdXQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2NvcGVbaW5wdXQubmFtZV0gPSBpbnB1dDtcclxuICB9O1xyXG5cclxuICBwcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcclxuICAgIHJldHVybiAnW29iamVjdCAnICsgdGhpcy5uYW1lICsgJ10nXHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gTnVkaXN0KHByb2dyYW0pIHtcclxuICAgIHRoaXMuZXhwb3NlKHByb2dyYW0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIE51ZGlzdDtcclxufSh0aGlzKSk7XHJcblxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgaWYgKCEhdGhpcy5xdWV1ZSkge1xyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnF1ZXVlLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIG5ldyBOdWRpc3QodGhpcy5xdWV1ZVtpXSwgdGhpcyk7XHJcbiAgICB9XHJcbiAgfVxyXG59KS5jYWxsKHRoaXMpO1xyXG5cclxubmV3IE51ZGlzdChOdWRpc3QsIHRoaXMpO1xyXG4iLCJ2YXIgVGVtcGxhdGU7XHJcbnZhciBBbGNoZW1pc3Q7XHJcblxyXG5BbGNoZW1pc3QgPSByZXF1aXJlKCcuL2FsY2hlbWlzdCcpO1xyXG5cclxuVGVtcGxhdGUgPSAoZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgdmFyIHByb3RvdHlwZTtcclxuICB2YXIgY29uc3RydWN0b3I7XHJcblxyXG4gIGNvbnN0cnVjdG9yID0gVGVtcGxhdGU7XHJcbiAgcHJvdG90eXBlID0gVGVtcGxhdGUucHJvdG90eXBlO1xyXG5cclxuICBjb25zdHJ1Y3Rvci5jbGFzc05hbWUgPSBcIlRlbXBsYXRlXCI7XHJcblxyXG4gIGZ1bmN0aW9uIHF1ZXJ5KG9iamVjdCwgcHJvcGVydHkpIHtcclxuICAgIHZhciByZWdleDtcclxuICAgIHZhciBmaWx0ZXI7XHJcbiAgICB2YXIgcmVkdWNlO1xyXG5cclxuICAgIHJlZ2V4ID0gL1sue31dL2c7XHJcbiAgICBmaWx0ZXIgPSBmdW5jdGlvbiBmaWx0ZXIoc291cmNlKSB7IHJldHVybiBzb3VyY2U7IH07XHJcbiAgICByZWR1Y2UgPSBmdW5jdGlvbiByZWR1Y2Uoc291cmNlLCBrZXkpIHsgcmV0dXJuIHNvdXJjZVtrZXldOyB9O1xyXG5cclxuICAgIHJldHVybiBwcm9wZXJ0eVxyXG4gICAgICAuc3BsaXQocmVnZXgpXHJcbiAgICAgIC5maWx0ZXIoZmlsdGVyKVxyXG4gICAgICAucmVkdWNlKHJlZHVjZSwgb2JqZWN0KTtcclxuICB9XHJcblxyXG4gIHByb3RvdHlwZS5zZXRFbGVtZW50ID0gZnVuY3Rpb24gc2V0RWxlbWVudChlbGVtZW50KSB7XHJcbiAgICBpZiAodHlwZW9mIEFsY2hlbWlzdCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgZWxlbWVudCA9IEFsY2hlbWlzdC5wcm90b3R5cGUuYXNFbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcblxyXG4gICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgcHJvdG90eXBlLmNvbXBpbGUgPSBmdW5jdGlvbiBjb21waWxlKHZhbHVlLCBkYXRhKSB7XHJcbiAgICB2YXIgcmVnZXg7XHJcbiAgICB2YXIgcmVwbGFjZW1lbnQ7XHJcblxyXG4gICAgcmVnZXggPSAvXFx7KFtefV0rKVxcfS9nO1xyXG5cclxuICAgIHJlcGxhY2VtZW50ID0gZnVuY3Rpb24gcmVwbGFjZW1lbnQob3JpZ2luYWwsIHByb3BlcnR5KSB7XHJcbiAgICAgIHJldHVybiBxdWVyeShkYXRhLCBwcm9wZXJ0eSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhbHVlID0gdmFsdWUudHJpbSgpO1xyXG4gICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKHJlZ2V4LCByZXBsYWNlbWVudCk7XHJcblxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG4gIH07XHJcblxyXG4gIHByb3RvdHlwZS5jcmF3bCA9IGZ1bmN0aW9uIGNyYXdsKGVsZW1lbnQsIGRhdGEpIHtcclxuICAgIHZhciBkb0F0dHJpYnV0ZXM7XHJcbiAgICB2YXIgZG9DaGlsZHJlbjtcclxuXHJcbiAgICB2YXIgc2VsZiwgYXJncztcclxuXHJcbiAgICBzZWxmID0gdGhpcztcclxuICAgIGFyZ3MgPSBhcmd1bWVudHM7XHJcblxyXG4gICAgZG9BdHRyaWJ1dGVzID0gZnVuY3Rpb24gZG9BdHRyaWJ1dGVzKGVsZW1lbnQpIHtcclxuICAgICAgdmFyIGF0dHJpYnV0ZXM7XHJcbiAgICAgIHZhciBhdHRyaWJ1dGU7XHJcblxyXG4gICAgICB2YXIgbG9vcDtcclxuXHJcbiAgICAgIGxvb3AgPSBmdW5jdGlvbiBsb29wKGF0dHJpYnV0ZSkge1xyXG4gICAgICAgIHZhciBjb21waWxlZDtcclxuXHJcbiAgICAgICAgaWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKGF0dHJpYnV0ZS5uYW1lKSkge1xyXG4gICAgICAgICAgY29tcGlsZWQgPSBzZWxmLmNvbXBpbGUoYXR0cmlidXRlLnZhbHVlLCBkYXRhKTtcclxuICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZS5uYW1lLCBjb21waWxlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgYXR0cmlidXRlcyA9IChbXSkuc2xpY2UuY2FsbChlbGVtZW50LmF0dHJpYnV0ZXMsIDApO1xyXG5cclxuICAgICAgcmV0dXJuIGF0dHJpYnV0ZXMubWFwKGxvb3ApO1xyXG4gICAgfTtcclxuXHJcbiAgICBkb0NoaWxkcmVuID0gZnVuY3Rpb24gZG9DaGlsZHJlbigpIHtcclxuICAgICAgdmFyIHRleHROb2RlID0gZG9jdW1lbnQuVEVYVF9OT0RFO1xyXG4gICAgICB2YXIgZWxlbWVudE5vZGUgPSBkb2N1bWVudC5FTEVNRU5UX05PREU7XHJcblxyXG4gICAgICB2YXIgc2V0RWxlbWVudDtcclxuICAgICAgdmFyIHNldFRleHROb2RlO1xyXG5cclxuICAgICAgdmFyIGNoaWxkcmVuO1xyXG4gICAgICB2YXIgY2hpbGQ7XHJcblxyXG4gICAgICB2YXIgbG9vcDtcclxuICAgICAgdmFyIGZpeEVsZW1lbnQ7XHJcbiAgICAgIHZhciBmaXhUZXh0Tm9kZTtcclxuXHJcbiAgICAgIHNldEVsZW1lbnQgPSBmdW5jdGlvbiBzZXRFbGVtZW50KGNoaWxkLCBpLCBkYXRhKSB7XHJcbiAgICAgICAgZWxlbWVudC5jaGlsZE5vZGVzW2ldID0gc2VsZi5jcmF3bChjaGlsZCwgZGF0YSk7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICBzZXRUZXh0Tm9kZSA9IGZ1bmN0aW9uIHNldFRleHROb2RlKGNoaWxkLCBpLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIGNvbXBpbGVkO1xyXG5cclxuICAgICAgICBjb21waWxlZCA9IHNlbGYuY29tcGlsZShjaGlsZC50ZXh0Q29udGVudCwgZGF0YSk7XHJcblxyXG4gICAgICAgIGVsZW1lbnQuY2hpbGROb2Rlc1tpXS50ZXh0Q29udGVudCA9IGNvbXBpbGVkLnRleHRDb250ZW50O1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgbG9vcCA9IGZ1bmN0aW9uIGxvb3AoY2hpbGQsIGkpIHtcclxuICAgICAgICBpZihjaGlsZC5ub2RlVHlwZSA9PT0gdGV4dE5vZGUpIHtcclxuICAgICAgICAgIHNldFRleHROb2RlKGNoaWxkLCBpLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNoaWxkLm5vZGVUeXBlID09PSBlbGVtZW50Tm9kZSkge1xyXG4gICAgICAgICAgc2V0RWxlbWVudChjaGlsZCwgaSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY2hpbGRyZW4gPSAoW10pLnNsaWNlLmNhbGwoZWxlbWVudC5jaGlsZE5vZGVzLCAwKTtcclxuXHJcbiAgICAgIHJldHVybiBjaGlsZHJlbi5tYXAobG9vcCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChlbGVtZW50Lmhhc0F0dHJpYnV0ZXMoKSkge1xyXG4gICAgICBkb0F0dHJpYnV0ZXMoZWxlbWVudCwgZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGVsZW1lbnQuaGFzQ2hpbGROb2RlcygpKSB7XHJcbiAgICAgIGRvQ2hpbGRyZW4oZWxlbWVudCwgZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgfTtcclxuXHJcbiAgZnVuY3Rpb24gaGFzUHJvcGVydGllcyhvYmplY3QsIGFycmF5KSB7XHJcbiAgICB2YXIgYXJlTWlzc2luZztcclxuXHJcbiAgICBhcmVNaXNzaW5nID0gZnVuY3Rpb24gYXJlTWlzc2luZyhwcm9wZXJ0eSkge1xyXG4gICAgICAgIHJldHVybiAhb2JqZWN0Lmhhc093blByb3BlcnR5KHByb3BlcnR5KTtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIGFycmF5LnNvbWUoYXJlTWlzc2luZyk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB2YWxpZGF0ZShkYXRhKSB7XHJcbiAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBwcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uIHByZXBhcmUoZGF0YSkge1xyXG4gICAgdmFyIGVsZW1lbnQ7XHJcbiAgICB2YXIgaHRtbDtcclxuICAgIHZhciBwcm9wZXJ0aWVzO1xyXG4gICAgdmFyIHJlc29sdmU7XHJcblxyXG4gICAgaWYgKHZhbGlkYXRlKGRhdGEpKSB7XHJcblxyXG4gICAgICBlbGVtZW50ID0gdGhpcy5lbGVtZW50LmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgcmVzb2x2ZSA9IHRoaXMuY3Jhd2woZWxlbWVudCwgZGF0YSk7XHJcblxyXG4gICAgICBodG1sID0gZWxlbWVudC5pbm5lckhUTUw7XHJcblxyXG4gICAgICBwcm9wZXJ0aWVzID0gL1xceyhbXn1dKylcXH0vZztcclxuXHJcbiAgICAgIHJldHVybiBlbGVtZW50O1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHByb3RvdHlwZS5waXBlID0gZnVuY3Rpb24gcGlwZSgpIHtcclxuICAgIC8vIHJlc29sdmUgZHVwbGljYXRlc1xyXG4gICAgLy8gdGhpcy5waXBlbGluZS5wdXNoKGZsb3cpO1xyXG4gIH07XHJcblxyXG4gIHByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcclxuICAgIHRoaXMucGlwZWxpbmUgPSBbXTtcclxuICB9O1xyXG5cclxuICBwcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcclxuICAgIHJldHVybiAnW29iamVjdCAnICsgdGhpcy5uYW1lICsgJ10nO1xyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIFRlbXBsYXRlKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG4gICAgdGhpcy5zZXRFbGVtZW50KGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIFRlbXBsYXRlO1xyXG59KCkpO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBUZW1wbGF0ZTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
